# OpenAI Codex/Copilot 专用配置

> 基于 [base.md](base.md) 通用配置的OpenAI Codex特定扩展

## OpenAI Codex 特性

### 代码生成优势
- **代码补全** - 实时智能代码补全
- **函数生成** - 基于注释生成完整函数
- **测试生成** - 自动生成单元测试
- **重构建议** - 智能代码重构推荐

### 集成环境
- **VS Code** - 通过GitHub Copilot集成
- **命令行** - 通过OpenAI CLI工具
- **IDE插件** - 支持多种开发环境
- **Web界面** - 浏览器端代码助手

## OpenAI Codex工作模式

### 实时编码辅助
1. **智能补全模式**
   ```javascript
   // 输入注释，自动生成代码
   // Function to calculate factorial of a number
   function factorial(n) {
       // Codex会自动补全函数实现
   }
   ```

2. **上下文感知生成**
   ```python
   # 基于已有代码模式生成相似功能
   def process_user_data(data):
       # 自动推断处理逻辑
   ```

3. **测试驱动开发**
   ```javascript
   // 先写测试，再生成实现
   describe('User Authentication', () => {
       it('should validate email format', () => {
           // Codex生成对应的实现代码
       });
   });
   ```

### 代码重构和优化
1. **性能优化**
   - 识别性能瓶颈
   - 提供优化建议
   - 生成改进版本

2. **代码简化**
   - 消除冗余代码
   - 提升可读性
   - 遵循最佳实践

3. **类型安全**
   - TypeScript类型推断
   - 类型注解生成
   - 类型错误修复

## OpenAI专用命令

### codex-generate 命令
**功能**: 基于描述生成代码

```bash
codex-generate --type [function|class|component] --desc "description"
```

**生成类型**:
- **function** - 生成函数实现
- **class** - 生成类定义
- **component** - 生成UI组件
- **api** - 生成API端点
- **test** - 生成测试用例

### codex-refactor 命令
**功能**: 智能代码重构

```bash
codex-refactor --file [filename] --strategy [optimize|simplify|modernize]
```

**重构策略**:
- **optimize** - 性能优化
- **simplify** - 简化逻辑
- **modernize** - 使用现代语法
- **secure** - 安全性增强

### codex-explain 命令
**功能**: 代码解释和文档生成

```bash
codex-explain --file [filename] --output [comment|doc|readme]
```

## 提示词工程最佳实践

### 有效提示词模式

#### 1. 任务明确模式
```
# 明确任务类型和期望输出
Generate a Python function that:
- Calculates the Fibonacci sequence up to n terms
- Returns a list of numbers
- Handles edge cases (n <= 0)
- Includes docstring and type hints
```

#### 2. 示例驱动模式
```javascript
// 提供示例，让Codex学习模式
// Example 1:
function addUser(user) { /* implementation */ }

// Example 2:
function deleteUser(userId) { /* implementation */ }

// Now generate:
function updateUser(userId, userData) {
    // Codex会基于模式生成
}
```

#### 3. 分步骤模式
```
Step 1: Create a database connection
Step 2: Define the user model
Step 3: Implement CRUD operations
Step 4: Add error handling
Step 5: Write unit tests
```

### 代码注释驱动开发

#### 函数生成模式
```python
def calculate_compound_interest(principal, rate, time, compound_frequency):
    """
    Calculate compound interest based on principal amount, interest rate,
    time period, and compounding frequency.

    Args:
        principal (float): Initial investment amount
        rate (float): Annual interest rate (as decimal)
        time (int): Investment time in years
        compound_frequency (int): Number of times interest compounds per year

    Returns:
        float: Final amount after compound interest
    """
    # Codex will generate the implementation
```

#### 类设计模式
```javascript
/**
 * UserManager class for handling user operations
 * Includes CRUD operations, validation, and authentication
 * Integrates with database and external APIs
 */
class UserManager {
    constructor(database, apiClient) {
        // Codex will implement constructor
    }

    // Create user with validation
    async createUser(userData) {
        // Implementation generated by Codex
    }

    // Update user with permission check
    async updateUser(userId, updates, requesterId) {
        // Implementation generated by Codex
    }
}
```

## OpenAI集成配置

### VS Code配置
```json
{
    "github.copilot.enable": {
        "*": true,
        "yaml": false,
        "plaintext": false,
        "markdown": true
    },
    "github.copilot.editor.enableAutoCompletions": true,
    "github.copilot.advanced": {
        "secret_key": "github.copilot.advanced",
        "length": 500,
        "temperature": 0.1,
        "top_p": 1,
        "stops": {
            "*": ["\n\n", "\n\r\n"]
        }
    }
}
```

### OpenAI CLI配置
```bash
# 设置API密钥
export OPENAI_API_KEY="your-api-key"

# 配置默认模型
export OPENAI_MODEL="gpt-4-turbo"

# 设置温度参数
export OPENAI_TEMPERATURE="0.1"
```

### 项目级配置
```json
{
    "name": "openai-codex-project",
    "scripts": {
        "generate": "openai api completions.create",
        "explain": "openai api edits.create",
        "test-gen": "codex-generate --type test",
        "refactor": "codex-refactor --strategy optimize"
    },
    "codex": {
        "model": "code-davinci-002",
        "maxTokens": 2048,
        "temperature": 0.1,
        "topP": 1,
        "presencePenalty": 0,
        "frequencyPenalty": 0,
        "bestOf": 1
    }
}
```

## 质量控制和安全

### 代码审查检查点
```markdown
# OpenAI Codex生成代码检查清单
- [ ] 逻辑正确性 - 算法实现是否正确
- [ ] 边界处理 - 是否处理了边界情况
- [ ] 错误处理 - 异常情况是否得到处理
- [ ] 性能考虑 - 是否存在性能问题
- [ ] 安全性 - 是否存在安全隐患
- [ ] 可读性 - 代码是否易于理解
- [ ] 测试覆盖 - 是否有相应的测试用例
```

### 安全最佳实践
1. **API密钥管理**
   - 使用环境变量存储密钥
   - 定期轮换API密钥
   - 限制API使用权限

2. **代码审查**
   - 人工验证生成的代码
   - 检查潜在的安全漏洞
   - 验证业务逻辑正确性

3. **数据隐私**
   - 避免在提示中包含敏感信息
   - 使用示例数据替代真实数据
   - 遵循数据保护规范

## 特定于OpenAI的Git提交规范

### 提交消息格式
```
[OpenAI] type(scope): description

Generated by: model-name
Context: brief description of the generation context
Validation: manual review completed

Co-authored-by: OpenAI Codex <ai@openai.com>
```

### 示例提交消息
```bash
[OpenAI] feat(auth): implement OAuth2 authentication flow

Generated by: gpt-4-turbo
Context: Based on industry standard OAuth2 implementation patterns
Validation: Security review completed, test coverage at 95%

实现功能:
- OAuth2授权码流程
- Token刷新机制
- 用户信息获取
- 错误处理和重试逻辑

性能指标:
- 认证响应时间: <200ms
- Token有效期: 1小时
- 刷新Token有效期: 30天

Co-authored-by: OpenAI Codex <ai@openai.com>
```

## 开发工作流程

### 1. 需求分析阶段
```markdown
# 使用OpenAI进行需求分析
1. 将需求转换为清晰的技术规格
2. 生成架构设计草案
3. 识别技术风险和挑战
4. 估算开发工作量
```

### 2. 设计阶段
```markdown
# 架构和设计生成
1. 生成系统架构图（伪代码）
2. 定义API接口规范
3. 设计数据模型
4. 创建组件结构
```

### 3. 实现阶段
```markdown
# 渐进式代码生成
1. 生成核心功能骨架
2. 实现具体业务逻辑
3. 添加错误处理和验证
4. 优化性能和可读性
```

### 4. 测试阶段
```markdown
# 自动测试生成
1. 生成单元测试用例
2. 创建集成测试
3. 编写端到端测试
4. 性能测试脚本
```

---

# 总结

此配置专门为OpenAI Codex/Copilot优化，充分利用其：
- **智能代码生成** - 基于自然语言描述生成代码
- **上下文理解** - 理解项目结构和代码模式
- **实时辅助** - 在编码过程中提供即时帮助
- **测试生成** - 自动创建完整的测试套件

通过引用`base.md`获得通用配置，然后添加OpenAI特有的提示词工程和工作流程，实现最高效的AI辅助开发。